---
title: "Piloto Sem limitação de dispersão"
author: "Danilo Pereira Mori"
date: '2022-03-19'
output: 
  html_document:
    toc: true
    toc_depth: 5
editor_options: 
  chunk_output_type: inline
---

<style>
body {
text-align: justify}
</style>

```{r setup, include=TRUE,echo=FALSE}
knitr::opts_chunk$set(echo = FALSE, tidy = FALSE, include = TRUE, warning = FALSE,cache = TRUE,message=FALSE,eval=FALSE)
```

```{r pacotes}
library(sads)
library(metR)
library(ggpubr)
library(imager)
library(OpenImageR)
library(cowplot)
library(twosamples)
library(doMC)
library(raster)
library(grid)
library(bbmle)
library(magrittr)
library(gridExtra)
library(ggplot2); theme_set(theme_classic())
library(readr)
library(purrr)
library(stringr)
library(tidyr)
library(plyr)
library(dplyr)
select <- dplyr::select
```


```{r dados,message=FALSE,echo=FALSE,eval=FALSE,include=FALSE}
### dados ###
# leitura
df_resultados <- read.csv(file="/home/danilo/Documentos/artigo_mestrado/1A.P_MOVER/simulacao_codigos_e_resultados/resultados/df_resultados.csv",
                            header = TRUE,as.is=FALSE) |> 
  select(SiteCode,p,Ntotal,S_obs,DA,txt.name) %>% 
  distinct()
```
```{r sorteio de pontos para o piloto,echo=TRUE,eval=FALSE}
f_random_byVar <- function(x = df_resultados,
                           column_name = "p", 
                           n_sample = 30, 
                           i_seed = 260320223){
  # amostra de uma uniforme
  set.seed(i_seed)
  sample_points <- sort(runif(n = n_sample, min = 0, max = 1))
  # encontra os valores mais próoximos
  df_x <- x
  f_index <- function(X=df_x,
                      name=column_name,
                      v_ref){
    which.min(abs(X[[column_name]] - v_ref))
  }
  # remove os sítios repetidos
  v_sites <- df_x[sapply(sample_points,function(y) f_index(v_ref=y)),"SiteCode"] %>% unique
  ## output:
  df_return <- filter(x,SiteCode %in% v_sites)
  df_return$SiteCode <- factor(df_return$SiteCode)
  return(df_return)
}
df_piloto <- f_random_byVar(x=df_resultados)
write.csv(df_piloto,file = "df_piloto.csv",row.names = FALSE)
```

# Estimativa de U

